# How to ...
Here we will have a description of the main functionalities of this repo and what to do to use it

## Log the experiment data 
To log all info required from and experiment log the analog, stateExt and inertial ports using [sensor calib][1] or this [yarpManagerApp][2].

## Prepare the experiment data 
To prepare the loged information to be used by the repo you need to create a [params.m](https://github.com/robotology-playground/insitu-ft-analysis/blob/master/paramsTemplate.m) file and put it in the directory of the experiment inside the data directory.
There are some variables that are common to all icub robots, some depend on the specific robot used, some depend on how and what you loged in the experiment and others depend on the characteristics of the experiment itslef. **Note:** a params.m copy from a previous similar experiment can be used directly. 

Detailed information on how to [Prepare the experiment data ](https://github.com/robotology-playground/insitu-ft-analysis/blob/master/docs/howToFiles/prepareData.md).


 

## Read an experiment
To read and experiment you can use [readExperiment.m](https://github.com/robotology-playground/insitu-ft-analysis/blob/master/utils/readExperiment.m).

This function is meant to read all info available in a dataset from analog, stateExt, inertial and skin\_events ports logged using [sensor calib][1] or this [yarpManagerApp][2]. It gives some extra functionalities depending on the options enabled.

Obtained Information:
-  timeStamp of the experiment
-  joints positions, velocities and accelerations
-  force/torque measurements and estimation
-  motor side enconder positions, velocities and accelerations (optional not implemented at the moment but ready for it)
-  joint torques
-  inertial data 

Detailed information on how to [Read an experiment](https://github.com/robotology-playground/insitu-ft-analysis/blob/master/docs/howToFiles/readAnExperiment.md)

## Analyze a sensor performance
To analyze a sensor performance the script [analyzeSensorUsingGridDataset.m](https://github.com/robotology-playground/insitu-ft-analysis/blob/master/analizeSensorUsingGridDataset.m) can be used.

This script takes a dataset of the "grid" type (generated by [sensorSelfCalibrator][1] module and copied to [greeny datasets][2] or [insitu big datasets][3] with the according params.m file [2] ) on the iCub robot and compare the eccentrity of the force measurement. In theory the "grid" movement is slowly (so the only thing that matters is gravity) moving the legs, while the robot is fixed on the pole (so the only external force are on the root_link).

The measured force should be equal to m*g , where g \in R^3 is the gravity expressed in the sensor frame. Hence the measured force should lie on a sphere (eccentrities 0,0) in theory. However imperfect sensor can have a different eccentricities ( but in general they remain linear, so the sphere become an ellipsoid).
For more on the theory behind this script, check [1,2].

Detailed info on how to [analyze a sensor performance]().

1. : [Traversaro, Silvio, Daniele Pucci, and Francesco Nori.
      "In situ calibration of six-axis force-torque sensors using accelerometer measurements."
      Robotics and Automation (ICRA), 2015 IEEE International Conference on. IEEE, 2015.](http://ieeexplore.ieee.org/document/7139477/)
2. : [F. J. A. Chavez, S. Traversaro, D. Pucci and F. Nori, 
      "Model based in situ calibration of six axis force torque sensors," 
      2016 IEEE-RAS 16th International Conference on Humanoid Robots (Humanoids), Cancun, 2016](http://ieeexplore.ieee.org/document/7803310/)


[1]:https://github.com/robotology-playground/sensors-calib-inertial/tree/feature/integrateFTSensors
[2]:https://github.com/robotology-playground/insitu-ft-analysis/blob/master/docs/yarpManagerApps/statesAndFtSensorsInertial.xml
[3]:https://gitlab.com/dynamic-interaction-control/icub-insitu-ft-analysis-big-datasets
